
apply plugin: 'java-library'
apply plugin: 'maven-publish'

sourceCompatibility = 17
targetCompatibility = 17


group = 'net.unicon'
version = project.version

repositories {
    mavenLocal()
    mavenCentral()
    maven { url "https://build.shibboleth.net/nexus/content/repositories/releases" }
    maven { url "https://build.shibboleth.net/nexus/content/repositories/thirdparty" }
}

test.onlyIf { !Boolean.getBoolean('skip.tests') }

configurations {
    provided
    compile.extendsFrom provided
}
configurations.implementation.transitive = false

dependencies {
    implementation "com.fasterxml.jackson.core:jackson-databind:2.0.1"
    implementation "org.apache.xmlbeans:xmlbeans:5.2.1"
    implementation "org.opensaml:opensaml-saml-api:5.1.2"
    implementation "org.opensaml:opensaml-profile-impl:4.0.1"
    implementation "org.opensaml:opensaml-storage-impl:4.2.0"
    implementation "net.spy:spymemcached:$project.spyMemCacheVersion"
    
    implementation "net.shibboleth.idp:idp-profile-api:${project.'shibIdpVersion'}"
    
    compileOnly "jakarta.servlet:jakarta.servlet-api:$project.servletVersion"
    compileOnly "org.apache.commons:commons-lang3:$project.commonLangVersion"
    
    compileOnly "net.shibboleth.idp:idp-authn-api:$project.shibIdpVersion"
    compileOnly "net.shibboleth.idp:idp-saml-api:$project.shibIdpVersion"
    
    
    testImplementation "junit:junit:$project.junitVersion"
}

// Apply a specific Java toolchain to ease working on different environments.
java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

test {
    jvmArgs "--add-opens", "java.base/java.lang=ALL-UNNAMED", "--add-opens", "java.base/java.lang.reflect=ALL-UNNAMED"
}
